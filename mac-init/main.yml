---
- hosts:
    - all
  gather_facts: yes

  vars_files:
    - default.config.yml

  pre_tasks:
    - name: "include optional custom config"
      include_vars: "{{ item }}"
      with_fileglob:
        - "{{ playbook_dir }}/config.yml"

  tasks:
    - import_tasks: tasks/openlens.yml
      when: config.install.openlens
      tags: ["k8s","openlens"]

    - import_tasks: tasks/kubectl.yml
      when: config.install.kubectl
      tags: ["k8s","kubectl"]



