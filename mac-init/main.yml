---
- hosts:
    - all
  gather_facts: yes

  vars_files:
    - default.config.yml

  pre_tasks:
    - name: "include optional custom config"
      include_vars: "{{ item }}"
      with_fileglob:
        - "{{ playbook_dir }}/config.yml"

  tasks:
    - import_tasks: tasks/shell_tools.yml
      when: config.install.shell_tools
      tags: ["shell","shell_tools"]

    - import_tasks: tasks/k8s_tools.yml
      when: config.install.k8s_tools
      tags: ["k8s","k8s_tools"]

    - import_tasks: tasks/network_tools.yml
      when: config.install.network_tools
      tags: ["network","network_tools"]

    - import_tasks: tasks/kafka_tools.yml
      when: config.install.kafka_tools
      tags: ["kafka","kafka_tools"]

    - import_tasks: tasks/redis_tools.yml
      when: config.install.redis_tools
      tags: ["redis","redis_tools"]

    - import_tasks: tasks/coding_tools.yml
      when: config.install.coding_tools
      tags: ["coding","coding_tools"]

    - import_tasks: tasks/db_tools.yml
      when: config.install.db_tools
      tags: ["db","db_tools"]
